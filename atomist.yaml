skill:
  description: Automatically update dependencies based on your own policy
  category:
    - DEPENDENCIES
    - DEV_EX
  package:
    use: atomist/package-cljs-skill
  repository: 'https://github.com/atomist-skills/update-leiningen-dependencies'
  license: Apache-2.0
  homepage: 'https://github.com/atomist-skills/update-leiningen-dependencies'
  name: atomist/update-npm-dependencies
  long_description: |
    Track all versions of npm dependencies and allow users to set
    cross repo targets for dependency versions.
  icon: 'https://cdn4.iconfinder.com/data/icons/logos-brands-5/24/npm-512.png'
  title: Update NPM Dependencies
  author: Atomist
  dispatch: single
  runtime:
    name: nodejs10
    entry_point: eventhandler
    memory: 1024
    timeout: 240
resource_providers:
  - name: github
    description: GitHub
    type_name: GitHubAppResourceProvider
    min_required: 1
    max_allowed: 1
  - name: slack
    description: Slack
    type_name: SlackResourceProvider
    min_required: 0
    max_allowed: 1
commands:
  - name: ShowNpmDependencies
    description: summary of the npm dependencies
    pattern: ^npm fingerprints.*$
  - name: UpdateNpmDependency
    description: update one dependency
    pattern: ^npm update.*$
  - name: SyncNpmDependency
    description: sync dependencies for one Repository
    pattern: ^npm sync.*$
parameters:
  - singleChoice:
      description: Choose how to select the target version
      displayName: Target Version
      name: policy
      required: false
      options:
        - description: Choose using the latest version used in a Repository on this team
          text: latest used
          value: latestSemVerUsed
        - description: Use the latest version available at npmjs.org
          text: latest available
          value: latestSemVerAvailable
        - description: Use a specific target version set here in this configuration
          text: manual
          value: manualConfiguration
  - string:
      description: >
        The `manual` policy requires an application/json formatted map of
        dependencies.

        The two `latest` policies require an application/json formatted array of
        Strings, which must refer to npm dependencies
      displayName: Policy Configuration
      name: dependencies
      lineStyle: multiple
      placeHolder: '{"library": "0.1.0", ...} or ["library", ...] for latest policies'
      required: false
  - repoFilter:
      description: The set of Repositories that should use this policy.
      displayName: Repository Scope
      name: scope
      required: false
